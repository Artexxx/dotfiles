
| **Название** | **Описание** |
|---------------|------------------------------------------------------------------|
| **chezmoi**   | Инструмент для управления dotfiles с поддержкой шаблонов и версионирования. |

# chezmoi

## Что такое chezmoi?

**chezmoi** — это инструмент для управления вашими личными конфигурационными файлами (dotfiles). С его помощью вы можете хранить все конфиги в одном месте (репозиторий Git), легко вносить изменения и синхронизировать их с вашей рабочей системой.

ChezMoi оперирует двумя основными понятиями:

- **Исходное состояние** (source state) — то, каким вы хотите видеть своё окружение (ваши dotfiles).
- **Целевое состояние** (target state) — результат применения исходного состояния на конкретной машине.

При этом chezmoi сохраняет все ваши файлы в **папке-источнике** (source directory) по умолчанию `~/.local/share/chezmoi`, а применяет их в **целевую директорию** (обычно домашнюю папку `~`).

---

## 1. Установка chezmoi

Установка может различаться для разных систем, но общая идея такова:

- **macOS**:  
  ```bash
  brew install chezmoi
  ```
- **Linux (Debian/Ubuntu)**:  
  ```bash
  sudo apt-get update
  sudo apt-get install chezmoi
  ```
  Или воспользуйтесь скриптом:
  ```bash
  sh -c "$(curl -fsLS get.chezmoi.io)" -- init
  ```

Убедитесь, что chezmoi установился корректно, набрав в терминале:
```bash
chezmoi --version
```

---

## 2. Инициализация chezmoi

Запустите в терминале:

```bash
chezmoi init
```

Данная команда создаст папку-источник `~/.local/share/chezmoi`, где chezmoi будет хранить ваши конфиги, и инициализирует внутри неё локальный Git-репозиторий. Пока вы не выполните `git commit`, в репозитории chezmoi не будет зафиксировано изменений.

---

## 3. Добавляем конфиг Neovim под управление chezmoi

Допустим, у вас уже есть директория с конфигурацией Neovim: `~/.config/nvim/`. Чтобы «положить» её под контроль chezmoi, используйте:

```bash
chezmoi add ~/.config/nvim
```

При этом chezmoi скопирует всю структуру `~/.config/nvim/` в вашу папку-источник `~/.local/share/chezmoi/dot_config/nvim/`.

> **Обратите внимание**: chezmoi заменяет точки в названиях папок на `_dot_`. То есть `~/.config` превратится в `dot_config`, и вы увидите файлы примерно по пути `~/.local/share/chezmoi/dot_config/nvim/init.vim`.

---

## 4. Редактируем файлы Neovim через chezmoi

Чтобы корректно вести версионность, изменения удобнее всего вносить напрямую в папку-источник. Не нужно править файлы в `~/.config/nvim` напрямую, лучше использовать команду:

```bash
chezmoi edit ~/.config/nvim/init.vim
```

Эта команда откроет файл `~/.local/share/chezmoi/dot_config/nvim/init.vim` в вашем `$EDITOR` (Vim, Nano, VSCode в терминале — что настроено). Отредактируйте содержимое и сохраните изменения.

---

## 5. Проверяем изменения перед применением

Перед тем как применить изменения из папки-источника в реальную домашнюю директорию, удобно посмотреть, **какие** правки будут внесены. Для этого:

```bash
chezmoi diff
```

Вам покажут разницу между текущими файлами в `~/.config/nvim` и изменениями, которые находятся в `~/.local/share/chezmoi/dot_config/nvim/`.

---

## 6. Применяем изменения (apply)

Когда вы убедились, что все изменения корректны, примените их с помощью:

```bash
chezmoi -v apply
```

Флаг `-v` (verbose) покажет, какие именно операции будут выполнены: добавление, изменение или удаление файлов.  
Если хотите сначала «репетировать» без реальных изменений, используйте комбинацию флагов `-n -v` (dry-run + verbose):

```bash
chezmoi -n -v apply
```

---

## 7. Сохраняем изменения в Git

После того как вы внесли правки в конфигурацию Neovim и применили их, вы наверняка захотите зафиксировать (commit) их в своём Git-репозитории. Для этого:

1. Перейдите в **папку-источник** chezmoi:

   ```bash
   chezmoi cd
   ```

   Теперь вы находитесь в `~/.local/share/chezmoi`, где и расположен Git-репозиторий.

2. Добавьте файлы в индекс и сделайте коммит:

   ```bash
   git add dot_config/nvim
   git commit -m "Update Neovim config"
   ```

3. Если вы ещё не привязывали репозиторий к GitHub (или другому сервису), сначала создайте на GitHub новый репозиторий **dotfiles** (или любое другое название), а затем свяжите его:

   ```bash
   git remote add origin git@github.com:ВАШ_НИК/dotfiles.git
   git branch -M main
   git push -u origin main
   ```

4. Вернитесь обратно в свою обычную рабочую директорию:

   ```bash
   exit
   ```

Теперь у вас есть полноценная система версионного контроля для Neovim (и любых других dotfiles).

---

## 8. Обновление изменений (pull и обновление локального окружения)

Каждый раз, когда вы будете менять что-то в конфигурации Neovim (или других dotfiles), достаточно повторять цикл:

1. **Редактирование** (в папке-источнике или через `chezmoi edit`).
2. **Проверка** (`chezmoi diff`).
3. **Применение** (`chezmoi apply`).
4. **Commit и push** (через `chezmoi cd`, `git commit`, `git push`).

Если вы внесли изменения где-то ещё и обновили свой репозиторий (например, работали на другой машине или в веб-редакторе GitHub), то для того, чтобы «забрать» обновлённые dotfiles в локальную машину, достаточно сделать:

```bash
chezmoi update -v
```

Это скачает последние изменения из Git и применит их к вашему локальному окружению (если есть конфликты, chezmoi подскажет, как их разрешить).

